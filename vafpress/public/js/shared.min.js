jQuery.fn.getAttributes=function(){var a={};if(!this.length){return this}jQuery.each(this[0].attributes,function(c,b){a[b.name]=b.value});return a};jQuery.fn.getDatas=function(){var a={},b="data-vp-";if(!this.length){return this}jQuery.each(this[0].attributes,function(d,c){if(c.name.substring(0,b.length)==b){a[c.name.substring(b.length)]=c.value}});return a};if(!String.prototype.trimChar){String.prototype.trimChar=function(a){return this.replace(new RegExp("^"+a+"+|"+a+"+$","g"),"")}}if(!String.prototype.format){String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})}}if(!String.prototype.replaceAll){String.prototype.replaceAll=function(c,d,a){var e,b=-1,f;if((e=this.toString())&&typeof c==="string"){f=a===true?c.toLowerCase():undefined;while((b=(f!==undefined?e.toLowerCase().indexOf(f,b>=0?b+d.length:0):e.indexOf(c,b>=0?b+d.length:0)))!==-1){e=e.substring(0,b).concat(d).concat(e.substring(b+c.length))}}return e}}jQuery.fn.validationVal=function(){var d=this,e="",a=d.prop("tagName"),b;if((d.length>1&&d.attr("type")!="radio")||d.attr("multiple")){e=[]}var c=e;d.each(function(f){var g=jQuery(this);switch(a){case"SELECT":if(g.has("[multiple]")){e=g.val()}else{e=g.val()}break;case"INPUT":switch(d.attr("type")){case"text":e=g.val();break;case"radio":b=g.attr("checked");if(typeof b!=="undefined"&&b!==false){e=g.val()}break;case"checkbox":b=g.attr("checked");if(d.length>1){if(typeof b!=="undefined"&&b!==false){e.push(g.val())}}else{e=null;if(typeof b!=="undefined"&&b!==false){e=g.val()}}break}break;case"TEXTAREA":e=g.val();break}});if(e===null){e=c}return e};var vp={};vp.isNumber=function(a){return !isNaN(parseFloat(a))&&isFinite(a)};vp.parseOpt=function(b){var d,c,a,g,f={};for(var e=0;e<b.length;e++){if(b[e]=="("){d=e}if(b[e]==")"){c=e;a=b.substring(d+1,c);g=a.split(":");f[g[0]]=vp.isNumber(g[1])?parseFloat(g[1]):g[1]}}return f};vp.wp_ext2type=function(c){var d={image:["jpg","jpeg","bmp","gif","png"],audio:["aac","ac3","aif","aiff","m3a","m4a","m4b","mka","mp1","mp2","mp3","ogg","oga","ram","wav","wma"],video:["asf","avi","divx","dv","flv","m4v","mkv","mov","mp4","mpeg","mpg","mpv","ogm","ogv","qt","rm","vob","wmv"],document:["doc","docx","docm","dotm","odt","pages","pdf","rtf","wp","wpd"],spreadsheet:["numbers","ods","xls","xlsx","xlsm","xlsb"],interactive:["swf","key","ppt","pptx","pptm","pps","ppsx","ppsm","sldx","sldm","odp"],text:["asc","csv","tsv","txt"],archive:["bz2","cab","dmg","gz","rar","sea","sit","sqx","tar","tgz","zip","7z"],code:["css","htm","html","php","js"]};var a="default";for(var b in d){if(d.hasOwnProperty(b)){if(jQuery.inArray(c,d[b])!==-1){a=b;break}}}return a};vp.jqid=function(a){return"#"+a.replace(/([:\.\[\]])/g,"\\$1")};vp.jqidwild=function(a){a=a.replace(/([:\.\[\]])/g,"\\$1");a="[id*="+a+"]";return a};vp.jqname=function(a){return'[name="'+a+'"]'};vp.jqnamewild=function(a){return'[name*="'+a+'"]'};vp.thejqid=function(b,a){if(a==="option"){return vp.jqid(b)}if(a==="metabox"){return vp.jqidwild(b)}return b};vp.thejqname=function(b,a){if(a==="option"){return vp.jqname(b)}if(a==="metabox"){return vp.jqnamewild(b)}return b};vp.validateAlphabet=function(a,c){if(jQuery.isArray(c)||jQuery.inArray(a,["vp-textbox","vp-textarea"])==-1){return true}var b=new RegExp(/^[A-Z]+$/i);return b.test(c)};vp.validateAlphaNumeric=function(a,c){if(jQuery.isArray(c)||jQuery.inArray(a,["vp-textbox","vp-textarea"])==-1){return true}var b=new RegExp(/^[A-Z0-9]+$/i);return b.test(c)};vp.validateNumeric=function(a,c){if(jQuery.isArray(c)||jQuery.inArray(a,["vp-textbox","vp-textarea"])==-1){return true}var b=new RegExp(/^[-+]?[0-9]*\.?[0-9]+$/);return b.test(c)};vp.validateEmail=function(a,c){if(jQuery.isArray(c)||jQuery.inArray(a,["vp-textbox","vp-textarea"])==-1){return true}var b=new RegExp(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i);return b.test(c)};vp.validateURL=function(a,c){if(jQuery.isArray(c)||jQuery.inArray(a,["vp-textbox","vp-textarea"])==-1){return true}var b=new RegExp(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/i);return b.test(c)};vp.validateMaxLength=function(a,b,c){if(jQuery.inArray(a,["vp-toggle","vp-radiobutton","vp-radioimage","vp-select"])!=-1){return true}return(b.length<=c)?true:false};vp.validateMinLength=function(a,b,c){if(jQuery.inArray(a,["vp-toggle","vp-radiobutton","vp-radioimage","vp-select"])!=-1){return true}return(b.length>=c)?true:false};vp.validateRequired=function(a,b){if(jQuery.isArray(b)&&jQuery.isEmptyObject(b)){return false}return(b)?true:false};vp.binding_action=function(a,j,b,l){var c=jQuery(vp.jqid(j.source)),g=jQuery('[name="'+j.source+'"]'),k=[];for(var f=0;f<a.length;f++){k.push(jQuery(vp.thejqname(a[f],l)).validationVal())}var e={action:"vp_ajax_wrapper",func:b,params:k};var d=c.find(".vp-js-bind-loader"),h=c.find(".input");h.fadeOut(100,function(){d.removeClass("hidden");d.fadeIn(100)});jQuery.post(ajaxurl,e,function(i){d.fadeOut(100,function(){h.fadeIn(100)});if(i.status){var m;switch(j.type){case"vp-select":case"vp-multiselect":m=jQuery('[name="'+j.source+'"]');m.empty();i.data!==null&&jQuery.each(i.data,function(n,o){m.append(jQuery("<option></option>").attr("value",o.value).text(o.label))});m.trigger("liszt:updated");break;case"vp-checkbox":m=h;m.empty();m=jQuery(vp.jqid(j.source)).find(".input");i.data!==null&&jQuery.each(i.data,function(n,o){m.append(jQuery('<label><input type="checkbox" name="'+j.source+'" value="'+o.value+'"><span></span>'+o.label+"</label>"))});break;case"vp-checkimage":m=h;m.empty();m=jQuery(vp.jqid(j.source)).find(".input");i.data!==null&&jQuery.each(i.data,function(n,o){m.append(jQuery('<label><input type="checkbox" name="'+j.source+'" value="'+o.value+'"><img src="'+o.img+'" alt="'+o.label+'" class="vp-js-tipsy image-item" style="" original-title="'+o.value+'"></label>'))});vp.init_tipsy();break;case"vp-radiobutton":m=h;m.empty();m=jQuery(vp.jqid(j.source)).find(".input");i.data!==null&&jQuery.each(i.data,function(n,o){m.append(jQuery('<label><input type="radio" name="'+j.source+'" value="'+o.value+'"><span></span>'+o.label+"</label>"))});break;case"vp-radioimage":m=h;m.empty();m=jQuery(vp.jqid(j.source)).find(".input");i.data!==null&&jQuery.each(i.data,function(n,o){m.append(jQuery('<label><input type="radio" name="'+j.source+'" value="'+o.value+'"><img src="'+o.img+'" alt="'+o.label+'" class="vp-js-tipsy image-item" style="" original-title="'+o.value+'"></label>'))});vp.init_tipsy();break}jQuery('[name="'+j.source+'"]').change()}},"JSON")};vp.binding_event=function(a,h,f,c,g,j){var e=["vp-select","vp-checkbox","vp-checkimage","vp-radiobutton","vp-radioimage","vp-multiselect","vp-toggle","vp-upload"],i=["vp-textbox","vp-slider","vp-color","vp-date"],b=vp.thejqname(a[h],j),d=jQuery(vp.thejqid(a[h],j)).attr("data-vp-type");if(jQuery.inArray(d,e)!==-1){jQuery(g).delegate(b,"change",function(){vp.binding_action(a,f,c,j)})}else{if(jQuery.inArray(d,i)!==-1){jQuery(b).typing({stop:function(l,k){vp.binding_action(a,f,c,j)},delay:400})}}};vp.dependency_action=function(a,h,b){var c=jQuery(vp.jqid(h.source)),g=jQuery('[name="'+h.source+'"]'),j=[],f=[];for(var e=0;e<a.length;e++){f.push(jQuery(vp.jqid(a[e])));j.push(jQuery('[name="'+a[e]+'"]').validationVal())}var d={action:"vp_ajax_wrapper",func:b,params:j};jQuery.each(f,function(i,l){var k=l.find(".vp-js-bind-loader");k.fadeIn(100)});jQuery.post(ajaxurl,d,function(i){jQuery.each(f,function(k,m){var l=m.find(".vp-js-bind-loader");l.fadeOut(100)});if(i.status){if(i.data){c.fadeIn()}else{c.fadeOut()}}},"JSON")};vp.dependency_event=function(a,h,f,c,g){var e=["vp-select","vp-checkbox","vp-checkimage","vp-radiobutton","vp-radioimage","vp-multiselect","vp-toggle","vp-upload"],i=["vp-textbox","vp-slider","vp-color","vp-date"],b=vp.thejqname(a[h],"option"),d=jQuery(vp.thejqid(a[h],"option")).attr("data-vp-type");if(jQuery.inArray(d,e)!==-1){jQuery(g).delegate(b,"change",function(){vp.dependency_action(a,f,c)})}else{if(jQuery.inArray(d,i)!==-1){jQuery(b).typing({stop:function(k,j){vp.dependency_action(a,f,c)},delay:400})}}};function theValidate(b,a,e){var c=jQuery(b),d=c.val();if(d===""){return}if(!vp.validateNumeric("vp-textbox",d)){c.val(a.min);e.slider("value",a.min)}if(d>a.max){c.val(a.max);e.slider("value",a.max)}else{if(d<a.min){c.val(a.min);e.slider("value",a.min)}else{e.slider("value",c.val())}}}if(jQuery.fn.slider){jQuery(".vp-js-slider").each(function(b,c){var d=jQuery(this),a=jQuery(this).getDatas();a=vp.parseOpt(a.opt);a.range="min";a.slide=function(e,f){d.prev(".slideinput").val(f.value);d.prev(".slideinput").trigger("keypress");d.prev(".slideinput").trigger("keyup")};d.slider(a);d.prev(".slideinput").keypress(function(g){var f=(typeof g.which=="number")?g.which:g.keyCode;if(g.altKey||g.ctrlKey||g.shiftKey){return true}if(jQuery.inArray(f,[45,46,8,0])!=-1||(f>=48&&f<=57)){return true}return false}).keyup(function(f){theValidate(this,a,d)})})}vp.upload_callback=function(){};if(vp_wp.use_new_media_upload){var _orig_send_attachment=wp.media.editor.send.attachment,_orig_send_link=wp.media.editor.send.link,_orig_send_to_editor=window.send_to_editor;vp.upload_callback=function(c){var b=jQuery(this),d=b.parent(".buttons").prev("input"),a=b.parent(".buttons").siblings(".image").find("img");wp.media.editor.send.attachment=function(e,f){d.val(f.url);d.trigger("change");if(f.type==="image"){a.attr("src",f.url)}else{a.attr("src",f.icon)}wp.media.editor.send.attachment=_orig_send_attachment;window.send_to_editor=_orig_send_to_editor};window.send_to_editor=function(e){if(e!==""){var f=get_url_info(e);d.val(f.imgurl);d.trigger("change");a.attr("src",f.iconurl)}window.send_to_editor=_orig_send_to_editor;wp.media.editor.send.attachment=_orig_send_attachment};wp.media.editor.open(b);return false}}else{var _orig_send_to_editor=window.send_to_editor;vp.upload_callback=function(c){var a=true,d=jQuery(this).parent(".buttons").prev("input"),b=jQuery(this).parent(".buttons").siblings(".image").find("img");tb_show("Upload Image","media-upload.php?referer=vafpress&TB_iframe=true&post_id=0");window.send_to_editor=function(e){if(e!==""){var f=get_url_info(e);d.val(f.imgurl);d.trigger("change");b.attr("src",f.iconurl)}window.send_to_editor=_orig_send_to_editor;tb_remove()};return false}}function get_url_info(c){var e,d,a,f,b=jQuery(c);if(b.prop("tagName")=="A"){a=jQuery(c).attr("href");e=a.split(".").pop();d=vp.wp_ext2type(e);f=a;if(d!=="image"){f=vp_wp.wp_include_url+"images/crystal/"+d+".png"}}else{if(b.prop("tagName")=="IMG"){a=jQuery(c).attr("src");f=a}}return{imgurl:a,iconurl:f}}vp.remove_upload_callback=function(c){var b=jQuery(this),d=b.parent(".buttons").prev("input"),a=b.parent(".buttons").siblings(".image").find("img");d.val("");a.attr("src","")};jQuery(".vp-js-upload").click(vp.upload_callback);jQuery(".vp-js-remove-upload").click(vp.remove_upload_callback);if(jQuery.fn.ColorPicker){jQuery(".vp-js-colorpicker").each(function(){var a=this;jQuery(a).ColorPicker({color:jQuery(a).attr("value"),onSubmit:function(b,e,c,d){jQuery(d).val(e);jQuery(d).ColorPickerHide()},onBeforeShow:function(){jQuery(a).ColorPickerSetColor(this.value)},onShow:function(b){jQuery(b).stop(true,true).fadeIn(500);return false},onHide:function(b){jQuery(b).stop(true,true).fadeOut(500);return false},onChange:function(b,d,c){jQuery(a).prev("label").css("background-color","#"+d);jQuery(a).attr("value","#"+d);jQuery(a).trigger("keypress");jQuery(a).trigger("keyup")}}).bind("keyup",function(b){var c=this.value.trimChar("#");if(this.value!=("#"+c)){jQuery(a).attr("value","#"+c)}jQuery(this).ColorPickerSetColor(c);jQuery(this).prev("label").css("background-color","#"+c)})})}if(jQuery.fn.datepicker){jQuery(".vp-js-datepicker").each(function(){var a=jQuery(this).getDatas();a=vp.parseOpt(a.opt);a.onSelect=function(){jQuery(this).trigger("keypress");jQuery(this).trigger("keyup");jQuery(this).trigger("blur")};jQuery(this).datepicker(a);jQuery(this).datepicker("setDate",a.value)})}vp.init_tipsy=function(){if(jQuery.fn.tipsy){jQuery(".vp-js-tipsy.description").each(function(){jQuery(this).tipsy({gravity:"e"})});jQuery(".vp-js-tipsy.slideinput").each(function(){jQuery(this).tipsy({trigger:"focus"})});jQuery(".vp-js-tipsy.image-item").each(function(){jQuery(this).tipsy()})}};vp.init_tipsy();if(ace!=="undefined"){jQuery(".vp-js-codeeditor").each(function(){var c=ace.edit(jQuery(this).get(0));var a=jQuery(this).prev();var b=jQuery(this).getDatas();b=vp.parseOpt(b.opt);c.setTheme("ace/theme/"+b.theme);c.getSession().setMode("ace/mode/"+b.mode);c.getSession().setUseWrapMode(true);c.setShowPrintMargin(false);c.getSession().setValue(a.val());c.getSession().on("change",function(){var d=c.getSession().getDocument();a.text(c.getSession().getValue())})})};