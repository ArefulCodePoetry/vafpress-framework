(function(l){var o=l.fn.addClass;l.fn.addClass=function(){var i=o.apply(this,arguments);if(this.prop("tagName")=="BODY"&&arguments[0]=="folded"){m()}return i};var b=l.fn.removeClass;l.fn.removeClass=function(){var i=b.apply(this,arguments);if(this.prop("tagName")=="BODY"&&arguments[0]=="folded"){m()}return i};l(window).resize(function(){m()});l(window).load(function(){l(window).resize()});var m=function(){var i=l("#vp-overlay"),u=l("#vp-option-panel"),t=l(".vp-right-panel"),v=l("#vp-submit"),j=l("#vp-copyright");i.css("height",u.innerHeight());i.css("width",u.innerWidth());v.css("width",t.innerWidth())};var d=l(".vp-submit");l(window).load(function(){var i=parseInt(d.offset().top-l("#wpadminbar").innerHeight(),10);d.scrollspy({min:i,max:999999,onEnter:function(t,j){d.addClass("floating");d.css("top",l("#wpadminbar").innerHeight())},onLeave:function(t,j){d.removeClass("floating");d.css("top","0px")}});l(window).scroll()});var f=[];var c=[];var n=[];var p;l(".vp-menu-goto").each(function(u){var t=l(this).attr("href"),v=l(t),j=[];v.children(".vp-section").each(function(w){var x=l(this);p=x.attr("data-vp-dependency");p&&n.push({dep:p,type:"section",source:x.attr("id")});x.find(".vp-field").each(function(y){var A=l(this),i=A.attr("id"),B=A.attr("data-vp-validation"),D=A.attr("data-vp-bind"),z=A.getDatas().type,C=l('[name="'+i+'"]');p=A.attr("data-vp-dependency");p&&n.push({dep:p,type:"field",source:A.attr("id")});D&&c.push({bind:D,type:z,source:i});B&&j.push({name:i,rules:B,type:z})})});if(j.length>0){f.push({name:t.trim("#"),fields:j})}});l(".vp-js-menu-goto").click(function(t){t.preventDefault();window.location.hash=l(this).attr("href");var j=l(this),i=j.parent("li"),v=i.siblings("li"),u=l(j.attr("href"));v.removeClass("vp-current");i.addClass("vp-current");u.siblings(".vp-panel").removeClass("vp-current");u.addClass("vp-current");if(l.fn.chosen){u.find(".vp-js-chosen").chosen()}});var k=window.location.hash;if(k!==""){l('a[href="'+k+'"]').trigger("click")}else{l(".vp-current > .vp-js-menu-goto").click()}l(".vp-js-menu-dropdown").click(function(u){u.preventDefault();var t=l(this),j=t.parent("li"),v=j.siblings("li"),i=t.next("ul");if(j.hasClass("vp-current")){return}v.removeClass("vp-current");j.addClass("vp-current");i.children("li.vp-current").children("a").click()});for(var h=0;h<c.length;h++){var q=c[h],s=q.bind.split("|"),e=s[0],r=s[1],a=[];r=r.split(",");for(var g=0;g<r.length;g++){a.push(r[g])}for(var g=0;g<a.length;g++){vp.binding_event(a,g,q,e,".vp-wrap","option")}}for(var h=0;h<n.length;h++){var q=n[h],s=q.dep.split("|"),e=s[0],r=s[1],a=[];r=r.split(",");for(var g=0;g<r.length;g++){a.push(r[g])}for(var g=0;g<a.length;g++){vp.dependency_event(a,g,q,e,".vp-wrap")}}l(".vp-js-save").bind("click",function(R){R.preventDefault();l(".vp-option-form .vp-field").removeClass("vp-error");l(".validation-notif.vp-error").remove();l(".validation-msg.vp-error").remove();var S='<li class="validation-msg vp-error"></li>',x='<em class="validation-notif vp-error"></em>',M=0;for(var Q=0;Q<f.length;Q++){var D=f[Q];D.nError=0;for(var P=0;P<D.fields.length;P++){var t=D.fields[P],V=l("#"+t.name),K=V.children("div.field").children(".validation-msgs").children("ul"),u=l('[name="'+t.name+'"]'),X=u.validationVal(),v=t.type,C=t.rules.split("|");t.nError=0;for(var N=0;N<C.length;N++){var z=C[N],B=z.indexOf("["),A=z.indexOf("]"),H=(B>=0)?z.substring(0,B):z,W="",J;switch(H){case"alphabet":if(!vp.validateAlphabet(v,X)){W=vp_wp.val_msg.alphabet.format()}break;case"alphanumeric":if(!vp.validateAlphaNumeric(v,X)){W=vp_wp.val_msg.alphanumeric.format()}break;case"numeric":if(!vp.validateNumeric(v,X)){W=vp_wp.val_msg.numeric.format()}break;case"email":if(!vp.validateEmail(v,X)){W=vp_wp.val_msg.email.format()}break;case"url":if(!vp.validateURL(v,X)){W=vp_wp.val_msg.url.format()}break;case"maxlength":J=z.substring(B+1,A);if(!vp.validateMaxLength(v,X,J)){W=vp_wp.val_msg.maxlength.format(J)}break;case"minlength":J=z.substring(B+1,A);if(!vp.validateMinLength(v,X,J)){W=vp_wp.val_msg.minlength.format(J)}break;case"maxselected":J=z.substring(B+1,A);if(!vp.validateMaxLength(v,X,J)){W=vp_wp.val_msg.maxselected.format(J)}break;case"minselected":J=z.substring(B+1,A);if(!vp.validateMinLength(v,X,J)){W=vp_wp.val_msg.minselected.format(J)}break;case"required":if(!vp.validateRequired(v,X)){W=vp_wp.val_msg.required.format()}break}if(W!==""){t.nError+=1;D.nError+=1;M+=1;var I=l(S);I.html(W);I.appendTo(K)}}if(t.nError>0){V.addClass("vp-error")}}if(D.nError>0){var O=l(x),F=l('[href="'+D.name+'"]'),E=F.parent("li").parent("ul");O.appendTo(F);if(E.hasClass("vp-menu-level-2")){if(E.siblings("a").children(".validation-notif.vp-error").length===0){O.clone().appendTo(E.siblings("a"))}}}}if(M>0){return}var L=l(".vp-js-save-loader"),w=l(this),U=l(".vp-js-save-status"),y=l("#vp-option-form"),G=y.serializeArray(),T={action:"vp_ajax_save",option:G,nonce:vp_wp.nonce};w.attr("disabled","disabled");L.stop(true,true).fadeIn(100);l.post(ajaxurl,T,function(i){U.html(i.message);if(i.status){U.addClass("success")}else{U.addClass("failed")}L.stop(true,true).fadeOut(100,function(){U.stop(true,true).fadeIn(100)});setTimeout(function(){w.removeAttr("disabled");U.stop(true,true).fadeOut(1000,function(){U.removeClass("success").removeClass("failed")})},3000)},"JSON")});l("#vp-js-import").bind("click",function(t){t.preventDefault();var v=l("#vp-js-import_text"),i=l("#vp-js-import-status"),u=l("#vp-js-import-loader"),j=l(this);data={action:"vp_ajax_import_option",option:v.val(),nonce:vp_wp.nonce};j.attr("disabled","disabled");u.fadeIn(100);l.post(ajaxurl,data,function(w){u.fadeOut(0);if(w.status){i.html(vp_wp.impexp_msg.import_success)}else{i.html(vp_wp.impexp_msg.import_failed+": "+w.message)}i.fadeIn(100);setTimeout(function(){i.fadeOut(1000,function(){j.removeAttr("disabled");i.fadeOut(500);if(w.status){location.reload()}})},2000)},"JSON")});l("#vp-js-export").bind("click",function(t){t.preventDefault();var u=l("#vp-js-export-status"),j=l("#vp-js-export-loader"),i=l(this);data={action:"vp_ajax_export_option",nonce:vp_wp.nonce},i.attr("disabled","disabled");j.fadeIn(100);l.post(ajaxurl,data,function(v){j.fadeOut(0);if(!l.isEmptyObject(v.option)&&v.status){l("#vp-js-export_text").val(v.option);u.html(vp_wp.impexp_msg.export_success)}else{u.html(vp_wp.impexp_msg.export_failed+": "+v.message)}u.fadeIn(100);setTimeout(function(){u.fadeOut(1000,function(){i.removeAttr("disabled");u.fadeOut(500)})},3000)},"JSON")})}(jQuery));